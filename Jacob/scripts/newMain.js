"use strict"; //Use strict javascript
//Import the eigenvectors
const eightElems =     [[1,0.616945,0.233891,-0.149164,-0.532218,-0.130692,0.0515996,0.0331275,-0.167636],[-0.0219658,0.0282656,0.0784971,0.128729,0.17896,1,0.539249,-0.332023,-0.742543],[0.0414734,0.244014,0.446555,0.649096,0.851637,0.298192,0.372374,0.723278,1],[-0.32455375537112252,-0.29097320324916126,-0.25739265112719995,-0.22381209900523868,-0.19023154688327742,-1,-0.6286972452763554,0.14749267908646771,0.55237764141503332],[-1,-0.60786049425890321,-0.21572390278020637,0.17641268869849044,0.5685492801771872,-0.50747144022847823,-0.36159730722154226,0.32228609313982637,0.86029754619105914],[-0.46785069641221011,-0.4166826861863473,-0.36551467596048459,-0.31434791400888268,-0.26317990378301992,-1,-0.6827573379802423,0.00289493525201409,0.37130542025649538],[-0.0542888,-0.0922562,-0.139107,-0.385605,-0.80398,1,0.125094,0.125094,1],[-0.40232840452569629,-0.083238320504817068,0.13989352853102643,0.0703701629520796,-0.10492512901265172,0.16656262199169511,-0.31815104651373471,0.64121552730884468,-1],[1,0.204783,-0.228178,0.0208954,0.644559,0.268764,-0.204932,-0.204932,0.268764],[1,0.13637093243834819,-0.2885755630137653,0.11733182547789291,0.84242910647405034,0.649666812588161,-0.99738151985343,0.11856243007928402,-0.01866846636509558],[3.23411E-14,1.32187E-14,2.1626E-14,1.37618E-14,-2.68236E-14,1,-0.955453,0.955453,-1],[0.56467572033811853,-0.4759161912015723,-0.61799354863571554,-0.26325011844124524,0.11786207318648886,-0.82748834288797168,0.71575234559001877,1,-0.26586829333532819],[0.915462,-0.360064,-0.51657,-0.224828,0.0525547,-0.529661,1,1,-0.529661],[0.69143,-0.546123,-0.10523,1,-0.835497,0.0172642,-0.0977217,-0.0977217,0.0172642],[-0.84959047279073452,0.026973266698397589,-0.044550015865460889,-1,0.74294482785974925,-0.44738765270506109,-0.10040456925273679,0.15310516817388545,0.3826967317150563],[-0.71774518143529953,1,-0.28058133986182288,0.34294736405319615,-0.18298221954812341,-0.040134401128654122,0.036064441170978657,0.053398203282225769,-0.0072100665988920941],[-0.69525,1,-0.26892,0.329966,-0.183586,-0.016418,0.0521315,0.0521315,-0.016418],[-0.79257444402563137,1,-0.29721683000376936,0.3126729174519412,-0.16136826234451565,-0.093751413494157568,-0.011916038447041087,0.065042404824726716,0.033219468526196762],[-0.19758196502182387,1,-0.034338913514366458,0.2179687306424837,-0.15262231994168129,0.4175902850860892,0.30158668059429772,-0.0035016777057487992,-0.31618852378847212],[-5.2505970536864569E-11,1.6030318615344663E-10,1.3669856045136751E-11,-9.4070200273957259E-11,3.109503974417077E-11,-0.11607092845030834,1,-1,0.11607092845030834],[-0.29422479187949657,1,0.0879916824251382,-0.58163033161620337,0.16536179277066534,0.014985545677831634,-0.12732917454590245,-0.12732917454590245,0.014985545677831634],[0.36375816545884371,0.28637432785694289,0.12624082223267613,-0.23318972447345071,-0.74356737508411086,-0.674891176838382,0.1132609433524084,-1,0.45222201711396809],[1.0587892929991171E-10,2.6492968314884821E-12,-4.3431333396609244E-11,-9.9044056153194551E-11,-1.7793145069582611E-10,-0.11456444383158339,1,-1,0.11456444383158339],[-0.076762462271782336,0.061089051640905646,0.27086903198309076,0.50356406621030381,0.88423199700783706,1,0.52814720745953181,-0.53599076256664957,-0.54176415841067438],[-0.0039027797457803709,0.012221712856845176,0.0015435048968535114,-0.0093457803709106058,0.0029401458637216085,-0.11667764117524485,0.995549072723484,-1,0.11694853094394664],[0.27890629705151038,-1,-0.093974395374648315,0.59182518992678246,-0.16329681060664722,-0.015270242366362955,0.13203632484147673,0.13203632484147673,-0.015270242366362955],[1.0570252944972066E-10,-4.3804128959459421E-10,-6.9290904551453118E-11,2.6327904360147471E-10,-9.3941123255957233E-11,0.1150959608569196,-1,1,-0.1150959608569196],[0.20357994574390303,-0.16481177780966633,-0.14732477808983005,-0.20048926152942059,-0.4071701413801822,-1,-0.52387199934400686,0.12981967022679597,0.42093233021053278],[-0.32909750411475958,-0.78629676466471343,-0.31437004358507781,0.12205752457995665,0.29851192918269531,-1,-0.51720717633373714,0.13827160791771445,0.88634334229490153],[-0.4082733385292136,0.092211991915562536,-0.13370761284527286,-0.27225532027317995,-0.21317816145097157,-1,-0.55414591617019582,0.13166840596557508,0.60414525567693955],[-0.25178369220028435,-0.2747056269316237,-0.14449332924659225,0.0015398776531889351,-0.059323090938503062,-1,-0.52438847879577366,0.42844158940171811,0.81419801963338534],[-0.30024831281809827,0.053782986928544205,-0.18549584090042823,-0.3338602273491626,-0.16835272751732025,-1,-0.57533183112486264,0.067490358960561422,0.58778951144593172],[-4.9519444093904822E-11,2.7448311235767528E-10,2.6650722767480961E-11,-1.4629009212181413E-10,5.0742714316535932E-11,0.12725958974651236,-1,1,-0.12725958974651236],[-0.30193758931674591,1,0.09368259571657625,-0.59564307532059524,0.17972865559462772,0.017406803455383365,-0.13146374987006088,-0.13146374987006088,0.017406803455383365],[0.044182320059666144,0.053168533796719895,-0.083169687137178316,-0.29951405922018809,-0.37507785048094294,0.56397963969644083,0.25421622826914353,-0.429354821347563,-1],[0.0051715913022405855,-0.026703377263104629,-0.00085826438030674114,0.015294540810183457,-0.0048733240566174322,-0.13400277082193429,1,-0.99684205552922245,0.1364841653165641],[-4.0564051272602846E-10,1.0785846515586203E-9,1.6601742426236414E-10,-6.1889295396520414E-10,1.8420498512883953E-10,-0.14008545433807984,1,-1,0.14008545433807984],[-1,0.50319554802924693,-0.28897417802090936,-0.20222263207071209,0.030645099829438673,-0.38722603872458539,0.776564660119591,0.37687956602125688,-0.14111884573116548],[-0.53848920863309346,0.90517387175250752,0.17370393016509034,-0.14334109565873523,0.0957224816891514,0.44462903456619873,-1,-0.088677195675647538,0.10361013178607203],[-0.47757890008064563,1,-0.44748997342484,-0.317307952521934,0.19883469817437854,-0.44996887837669614,0.95034071411947463,0.300558024236979,-0.17862296288678767],[-0.58387209943366924,1,-0.31963489199619105,0.61134081758799852,-0.35754356070098064,0.00053469403097278613,-0.0013678477756060075,-0.0013678477756060075,0.000534698207454184],[0.58399366345735559,-1,0.31965887731566978,-0.611420551082219,0.35748360460630535,-0.00055267702510813975,0.001400170725501301,0.0012717572414698809,-0.00058110692505314646],[0.59079815496000476,-1,0.032441252603102322,0.58264728206924743,-0.34479398999630217,0.021178723652712096,-0.047758509955041752,-0.047758509955041752,0.021178723652712096],[0.21521056035885011,-0.35271300027939484,-0.58773954278759488,0.21583250088985337,-0.13228981280546848,-0.48243639940446803,1,1,-0.48243639940446803],[2.1097513146321125E-9,-6.2701954527627265E-9,2.7872104667943537E-8,4.3895956530513552E-9,-2.5162496525411143E-9,0.48822637945937297,-1,1,-0.48822637945937297],[0.358746942155305,-1,-0.21999783088849217,0.80448558487681687,-0.49616876376137714,-0.38398782543128313,0.80107870259587566,-0.23813745625194749,0.26345925083020161],[-0.377844180718364,0.0082869859664860459,-0.247865475454483,-0.02788398207524679,-0.027513849659971151,-0.69403868611074071,1,0.15190258567393597,-0.035375930887065164],[-0.11618751632100496,0.17756566197996124,-0.42771512802539891,-0.24294760785607278,0.21123675421597329,-0.46786480023089921,1,0.49963750188980055,-0.1740815569207933]]


let sixteenElems = [[-1,-0.96621341920784154,-0.93242796636456438,-0.89864251352128721,-0.86485706067801,-0.8739979584125247,-0.79728502704257442,-0.76349957419929726,-0.7297141213560201,-0.69314940246908008,-0.73607575304687189,-0.77900323157354512,-0.82192958215133693,-0.8739979584125247,-0.88313885614703946,-0.89227975388155412,-0.90142065161606888],[-1,-0.84454884526480156,-0.689097690529603,-0.53364653579440469,-0.378196062922329,-0.28994183707562549,-0.067294094383493458,0.088156719420143609,0.24360719229221925,-0.10940834736834928,-0.17660527625684422,-0.24380220514533912,-0.31099913403383406,-0.28994183707562549,-0.20168761122892193,-0.11343406724534118,-0.025179909584949919],[-0.943992,-0.700993,-0.457994,-0.214995,0.0280042,0.152986,0.514002,0.757001,1,0.500071,0.382054,0.264038,0.146021,0.152986,0.277969,0.402951,0.527933],[1,0.872722,0.745443,0.618165,0.490886,0.410351,0.236329,0.109051,-0.0182275,0.303915,0.350658,0.397401,0.444143,0.410351,0.329815,0.249279,0.168744],[0.0711788,0.0605075,0.0498362,0.0391649,0.0284937,0.27137,0.00715109,-0.00352019,-0.0141915,-0.985698,-0.73215,-0.478602,-0.225054,0.27137,0.514247,0.757123,1],[0.30320269531105809,0.35233004137597779,0.40145772301249333,0.45058876036496764,0.49971644200148324,0.42377323413836954,0.59797180527451432,0.64709948691102992,0.69622716854754541,1,0.87492911050037081,0.74985822100074162,0.62478733150111232,0.42377323413836954,0.34783002627525594,0.27188681841214229,0.19594394612062455],[-0.11392,-0.110043,-0.107876,-0.110119,-0.121776,-0.0618363,-0.373844,-0.596428,-0.841234,1,0.498106,0.140446,-0.0618363,-0.0618363,0.140446,0.498106,1],[-0.42151004888647475,-0.740456903541711,-0.23515260294893292,0.026652496673987829,0.042954207306992891,0.26136472773933511,0.022199497752481718,-0.53429059506097032,-1,-0.38135307685646591,0.076816711144699248,0.40963244613434729,0.097921734407103889,0.26136472773933511,0.26389564587613856,0.45694920057624638,0.14477560242149431],[1,0.578213,0.196775,-0.0939293,-0.231571,-0.231665,0.00371073,0.284848,0.610396,0.298029,0.00561925,-0.169047,-0.231665,-0.231665,-0.169047,0.00561925,0.298029],[1,0.63860707575877851,0.27412717313646107,-0.081775555026329022,-0.24582096266306794,-0.27627636209679551,0.020335423778148235,0.30613744013124816,0.63978195866740761,0.405729935698976,-0.01284512185440978,-0.24039639067502847,-0.24182689000026464,-0.27627636209679551,-0.18945674896139295,-0.038362626022068747,0.31392500859993122],[-5.8725E-15,-2.78534E-15,-1.80248E-15,4.59218E-16,4.10658E-15,0.567921,-2.03672E-15,-2.8251E-15,-6.59191E-16,1,-0.35774,-0.847529,-0.567921,0.567921,0.847529,0.35774,-1],[0.020822152825132365,0.33971733474637006,0.36891420579663564,0.013826665566351194,-0.50878008313172951,0.10069189574221346,0.291386267194239,0.13547648727181125,-0.38677840659841817,-0.23130556774106684,0.4235987265296195,0.54545533515464506,-0.55423324661110074,0.10069189574221346,0.78944305215929678,1,-0.64352819051672849],[1,0.156278,-0.472464,-0.690531,-0.452584,0.115997,-0.0361794,-0.0609045,-0.143508,-0.593968,0.761522,0.884602,0.115997,0.115997,0.884602,0.761522,-0.593968],[0.699715,-0.0289333,-0.489739,-0.475906,-0.0627742,-0.00649275,1,0.36377,-0.908465,0.0930301,-0.220745,-0.201122,-0.00649275,-0.00649275,-0.201122,-0.220745,0.0930301],[-0.9001082448056863,-0.10094025035735688,0.64349035748459094,0.7832975178199475,0.05022409974274563,0.0636436883273357,-1,-0.22524073027459271,0.91649503957800493,-0.072306146538135274,0.684043310694523,0.19582517772051555,-0.50688158103406256,0.0636436883273357,0.17722133348660032,0.19079078311977071,-0.13554867982846872],[-0.85006692178634036,0.400519485415898,1,0.46762305125643294,-0.2708541482081927,-0.15527335597273575,0.35786862862852081,0.25903444115595603,-0.25027401576499547,-0.0481795119691702,0.24702891505915237,0.0818619068265608,-0.36685796153815081,-0.15527335597273575,0.060580374815864091,0.25021476911310453,-0.052151865326974189],[-0.875175,0.455243,1,0.404303,-0.272158,-0.214965,0.34212,0.248599,-0.23403,-0.0471597,0.19987,0.0710728,-0.214965,-0.214965,0.0710728,0.19987,-0.0471597],[-0.52832485444251776,1,0.48317332537121471,-0.25388411672159761,-0.12361849584859726,0.37669817062667238,0.18030208201747838,-0.13854086519137795,-0.1681501854637743,-0.050504427014550005,0.3377995842855338,0.004408295915203436,0.11492524029903881,0.37669817062667238,0.00673087081845221,0.067158557172222924,0.027205296340104962],[0.034184750001685305,-0.08224968147713714,-0.0085219415625709238,0.081621848758378773,0.0022499960676189766,-0.25556207207267939,-0.0026170557476804571,0.021379411850623451,-0.0039248308514391395,0.089346393332479443,-1,0.043950762095442256,0.21240879684870217,-0.25556207207267939,-0.020629967439885131,0.74592099734171036,-0.0660246773762255],[1.28292E-13,-4.5763E-13,-5.58625E-14,5.1428E-13,4.98139E-14,0.541423,3.28177E-14,1.59703E-13,-2.51133E-14,-0.102383,1,-0.0198207,-0.541423,0.541423,0.0198207,-1,0.102383],[0.0335611,-0.0688495,-0.0376461,0.097325,0.0369812,-0.256023,0.0142349,0.0394532,-0.0101486,-0.0930663,1,-0.0716571,-0.256023,-0.256023,-0.0716571,1,-0.0930663],[-2.60917E-12,7.08418E-12,2.06706E-12,-1.04176E-11,-1.41009E-13,-0.541181,-1.13974E-12,-6.191E-12,1.22651E-12,-0.083944,1,-0.148704,0.541181,-0.541181,0.148704,-1,0.083944],[-0.24350970290210591,0.68430431504014655,0.18518856583337914,-1,-0.01220701737280532,0.4708197238233241,-0.098158891310278162,-0.66069248506108857,0.1244693198685189,-0.069116568629789862,0.82449514725239159,-0.12443612804988731,0.4708197238233241,0.4708197238233241,-0.12443612804988731,0.82449514725239159,-0.069116568629789862],[-0.0046624571324210794,0.077397033259153536,0.039279418827237733,0.21483370423230677,-0.014518767037114697,0.73163373670005882,0.0036157306258835626,0.46252274433674473,0.048712315424211471,0.042499678704536685,-0.74701533424874356,0.1058651641312509,-1,0.73163373670005882,-0.100183307516961,0.50217466297796931,-0.040855322343901136],[1.84343E-13,-1.67674E-13,-1.04372E-13,3.51359E-13,-1.18437E-13,1,1.48653E-13,-8.9149E-13,9.3886E-14,0.0617527,-0.7327,0.139858,-1,1,-0.139858,0.7327,-0.0617527],[-0.20378234020655145,0.764617418461866,0.01488039890690989,-0.9124108315292615,-0.035792046704759196,0.19582460872342689,0.0090309472264612969,-1,0.13525126876530502,-0.044789455939241225,0.55020495439542894,-0.098529829293395321,0.88590694538098436,0.19582460872342689,-0.019868598502324589,-0.013195957695993184,-0.0081695443091883441],[0.238037,-0.903452,-0.0129625,1,0.0391914,-0.624932,-0.00415908,0.979423,-0.135077,0.0272742,-0.30579,0.0662348,-0.624932,-0.624932,0.0662348,-0.30579,0.0272742],[2.2187618623901514E-5,-6.2345253207182123E-5,-4.7084250011224626E-5,0.00026538814760997072,2.5262880769968609E-5,-1,-5.1671653122283133E-6,0.00055862316681428749,-7.5559292562766073E-5,-0.036084645934440017,0.36898492634603691,-0.086637795564843648,0.99955509659301944,-1,0.086673306203749426,-0.36903227386457793,0.036095707294375029],[0.10636973220019515,-0.4357063626431365,-0.017587132932453734,0.493327940084902,0.019653928592278758,-1,0.017487052033727263,0.2141076536867301,-0.034137135851479948,0.010328807452690925,0.22967690549861139,-0.017022968566257724,0.30659491422232971,-1,0.072050741015654313,-0.32708856325529806,0.00976964713143124],[-1.31965E-12,5.63587E-12,-1.63559E-13,-4.76404E-12,-6.06647E-14,1,-3.33817E-13,2.33371E-12,-2.51703E-13,0.035128,-0.348824,0.0833875,-1,1,-0.0833875,0.348824,-0.035128],[0.20203971923504044,-0.84042869234922557,0.046109184277350883,0.58845699519247774,-0.0030045717438408775,0.15596153982179864,0.0702884984921969,-0.9843454908553334,0.10650854578935083,0.052117526118356051,-0.24876746823475043,0.0905285445161473,-1,0.15596153982179864,-0.0204379820195366,0.065826627401698076,-0.020802141811297085],[-0.118,0.504631,-0.0427548,-0.332271,0.00780646,0.334264,-0.0613081,1,-0.122245,-0.0114583,0.110455,-0.0268084,0.334264,0.334264,-0.0268084,0.110455,-0.0114583],[-0.227233,1,-0.109409,-0.495282,0.0672584,-0.7664,0.00182839,-0.0189795,0.00226543,0.0258689,-0.233492,0.0586961,-0.7664,-0.7664,0.0586961,-0.233492,0.0258689],[-0.22893457565323069,1,-0.10807665952706225,-0.51249789906007182,0.068046319799688837,-0.74745409176905608,-0.0046406854020229352,0.081677972237425608,-0.0099994505234033918,0.026440598347691548,-0.21511362314093752,0.057621024913915332,-0.7507455643232388,-0.74745409176905608,0.056107701722555255,-0.22806726455466539,0.024271997379750818],[0.0179121302468929,0.15130816388060703,-0.10453460520585575,0.75935479548423834,-0.044181936953535894,0.47643713778432878,0.1125393621654216,-1,0.13753517470101503,-0.043719640883052489,-0.11725989079092827,-0.031903830692439114,0.4589795986734112,0.47643713778432878,-0.018494857793708755,0.21478844929818094,-0.0019033114468527017],[0.198693,-0.974565,0.223644,-0.581739,0.0151371,-0.439487,-0.14096,1,-0.106983,0.0178185,-0.0755508,0.0238131,-0.439487,-0.439487,0.0238131,-0.0755508,0.0178185],[9.9429437967965135E-12,-5.7226566202255709E-11,1.6001397971756234E-11,-7.2208084541749606E-11,3.3587100748744194E-13,-1,-9.34423277414463E-12,5.7439579186806935E-11,-6.0516064827978392E-12,-0.052405222253814804,0.11160980001895555,-0.04553833759833191,1,-1,0.04553833759833191,-0.11160980001895555,0.052405222253814804],[-0.10935548409398012,0.66909403249290322,-0.2004699005939225,1,0.0033871180617386113,-0.81522829878387293,0.11367132098002451,-0.62932741156630045,0.07617815580252861,-0.034627672389412049,0.15418333036546661,-0.066748090963369533,0.95503158159363966,-0.81522829878387293,0.0569447034053652,-0.12114343176176061,0.01644666743482041],[0.1417801042444953,-0.7063189667233235,0.20305797744246759,-1,-0.0077025281224977005,-0.1055963696006144,-0.14833958939218495,0.86080293861124435,-0.091131478444131567,0.0079042599742216637,-0.0016589371347945027,0.0035120452698539327,-0.1055963696006144,-0.1055963696006144,0.0035120452698539327,-0.0016589371347945027,0.0079042599742216637],[-0.085994444684622362,0.23614053290677736,-0.060221672214776714,0.27272743648494807,0.018253642298214516,0.50908052685429372,0.16087573674578129,-1,0.0807201374778436,-0.023288191892554006,-0.18539333938581704,0.044596176847808859,-0.15921940973873447,0.50908052685429372,-0.06253080281872811,0.18133133024944881,0.023630445433977489],[0.035558186173472228,0.032921982062280655,-0.017245835886580133,0.17023146342822124,-0.028629742075650381,-0.49495292741351454,-0.15803576402428834,1,-0.076314550721408275,0.027324661578742131,0.21326945574062725,-0.04969430672385939,0.21872319090858444,-0.49495292741351454,0.067969611720795492,-0.22585928360537016,-0.031867583978608435],[-0.017128743811881189,0.25235612623762377,-0.088373143564356438,0.55199566831683167,-0.040344059405940595,-0.49588180693069306,-0.16787376237623763,1,-0.084192759900990108,0.030174195544554454,0.24012995049504951,-0.05148855198019802,0.2338586014851485,-0.49588180693069306,0.069756497524752478,-0.25896844059405938,-0.039576423267326737],[-0.022419994506684263,0.28255988513447722,-0.096065303607422672,0.5921532780417057,-0.041514789081381009,-0.48645490758004911,-0.16848348154144183,1,-0.0846633309548342,0.030038990915683416,0.23791434205917961,-0.050813170587799314,0.23806548090491478,-0.48645490758004911,0.069153433540325743,-0.25780363285467855,-0.039349289138784695],[-0.102457,0.500316,-0.161244,1,-0.0392935,0.0080029,-0.0719643,0.377099,-0.0409335,-0.00334052,-0.0102095,0.000777553,0.0080029,0.0080029,0.000777553,-0.0102095,-0.00334052],[0.10887221363937322,-0.493237391456556,0.15921125731550467,-1,0.036259560575042434,-0.13607333389142992,0.048745880866673259,-0.23273388686367477,0.030385695477134531,0.015356433458397704,0.097512157626770374,-0.016402940661648872,0.070464615408032019,-0.13607333389142992,0.018987891840881586,-0.079611716984147526,-0.01063501244301707],[0.1140053668717643,-0.44474941045726835,0.14965711652617028,-1,0.031314883582251374,-0.39354240641856181,0.011347355866966636,-0.029845390724527691,0.01265437887946223,0.047052991082319147,0.31154256905103955,-0.050777491665085522,0.25538232184967341,-0.39354240641856181,0.061789499363022804,-0.31057219526739493,-0.047416040983384387],[2.24504E-13,-3.3892E-12,2.38332E-12,-1.94425E-11,2.03625E-13,-0.582235,-8.41473E-14,-1.5311E-12,9.04223E-14,0.182318,1,-0.127844,0.582235,-0.582235,0.127844,-1,-0.182318],[-0.0396275,0.18244,-0.064302,0.468024,-0.0503745,0.893922,0.0162921,-0.0792594,0.00919001,0.147602,1,-0.135881,0.893922,0.893922,-0.135881,1,0.147602],[-0.010984886767977244,0.025069991820829272,-0.011398690290751284,0.093525951935650234,-0.00082633588780470018,0.93617642002386026,0.0055871029585675509,-0.030141286057379223,0.0030929039181874542,-0.084425712812123924,-1,0.13226396319894138,-0.98510036415543545,0.93617642002386026,-0.12535959698047938,0.937786205854619,0.078145985173299432],[-2.4367834309193016E-11,7.0198501223064175E-11,-2.7923542041709779E-11,2.3116062510840119E-10,-1.8113909439423936E-12,0.98033528106553114,1.3989985227537784E-11,-6.66287387188029E-11,8.7507550701841474E-12,-0.084927602973630861,-1,0.1307078820356094,-0.98033528106553114,0.98033528106553114,-0.1307078820356094,1,0.084927602973630861],[-0.082878984422323054,0.31390647679349004,-0.1188507891699144,1,-0.0059520754997314188,-0.23339085911516966,0.059499039967084583,-0.27041784289747078,0.038778186680686194,-0.020348983393716356,-0.24992714035909802,0.03205381327359795,-0.23339085911516966,-0.23339085911516966,0.03205381327359795,-0.24992714035909802,-0.020348983393716356],[2.45724E-13,-2.03832E-13,2.84463E-13,6.80811E-12,6.20345E-14,-0.573916,4.37241E-13,-4.32114E-12,-8.1612E-14,0.0671054,1,-0.110785,0.573916,-0.573916,0.110785,-1,-0.0671054],[-0.0013124463097955476,0.0031469137246239341,-0.0031685847153823609,-0.034448357061696633,-0.000941460893318376,-0.70893737069233109,-0.0030921370830933066,0.056550168848925331,0.0030897115491509909,0.070017079801510479,0.9811559113005337,-0.1138408474353588,0.67989882058412054,-0.70893737069233109,0.11204263164657662,-1,-0.077148149591918347],[-8.7613960879903466E-5,-1.08028342354614E-5,-5.7267866317764161E-6,0.00017958322878206738,-2.1754131268595188E-5,-0.0994652949540572,1.7135833004743642E-5,-0.00012158834283256265,2.7268822215052994E-5,0.057996738000501848,0.9993607436880908,-0.08615382777120599,0.099485010335639446,-0.0994652949540572,0.086204609814675426,-1,-0.058031508764383274],[1.49086E-12,-2.09407E-12,9.07004E-13,-6.32246E-12,6.86138E-13,-0.163472,-3.82687E-13,1.99052E-12,-7.12439E-13,-0.0548683,-1,0.0704875,0.163472,-0.163472,-0.0704875,1,0.0548683],[0.13930745299607736,-0.20675587093820555,0.070995224172554078,-0.561614416964072,0.06547867525413853,-0.21011663840014982,-0.034201999812712644,0.16815594793411645,-0.068823627339791277,0.054378986359237942,1,-0.067249477156145626,-0.21011663840014982,-0.21011663840014982,-0.067249477156145626,1,0.054378986359237942],[-5.2492323374429781E-11,-9.344338251709075E-12,7.5281476270908E-12,-1.8793053338331739E-11,-1.9659406340955902E-11,0.45709935175161848,4.6147155331095281E-13,-2.0635485596586482E-11,1.8828940773096216E-11,0.052412713924071964,1,-0.0488199689144051,-0.45709935175161848,0.45709935175161848,0.0488199689144051,-1,-0.052412713924071964],[0.0416593,-0.0256061,0.00649014,-0.038334,0.0542589,-0.485411,-0.00202144,0.0132268,-0.0175684,0.0522304,1,-0.0461226,-0.485411,-0.485411,-0.0461226,1,0.0522304],[0.14851782504493707,0.13354085530257639,-0.053474385859796282,0.26860957159976034,-0.045759624026363091,0.46496779508687841,0.010825644098262433,0.016418701318154583,-0.0534455512282804,-0.052885897243858594,-0.96930422408627925,0.013390596914319951,0.66807594367884959,0.46496779508687841,0.055115525763930494,-1,-0.05211616237267825],[-0.25512,-0.0763306,0.048824,-0.418937,0.0328607,-0.666155,-0.0437073,0.1762,0.173277,0.0516163,1,-0.0253184,-0.666155,-0.666155,-0.0253184,1,0.0516163],[0.2795730117980138,0.38032399278464973,-0.14892086017096104,1,-0.040020328616890637,-0.50477133577771138,-0.12631378049019887,0.57861961711529952,0.32323809565355849,0.0050591427518229233,0.1347802568123769,-0.021195265962435681,-0.086686500882288145,-0.50477133577771138,-0.0018244104810160821,0.74925785280074686,0.040640002442923914],[0.345946,0.303409,-0.135738,1,-0.0472143,0.0918555,-0.0761555,0.350639,0.164404,-0.00667015,-0.128512,0.00164285,0.0918555,0.0918555,0.00164285,-0.128512,-0.00667015],[-0.40398815931108717,-0.29938284894151418,0.172916218155723,-1,0.041721564406171509,-0.54231880157875856,0.063078937926085391,0.17547721564406171,-0.056283010405453894,-0.0050176175098672407,0.27298259777538569,-0.028028256189451019,-0.48817994259059916,-0.54231880157875856,0.010692231790455687,0.67496142805884463,0.033972820236813778],[-4.26072E-12,1.1923E-11,-5.31165E-13,-7.61161E-12,1.03343E-12,-0.62723,1.35381E-12,-1.19883E-11,-2.62171E-13,-0.0561915,-1,-0.0255251,0.62723,-0.62723,0.0255251,1,0.0561915],[0.219815,0.667315,-0.21581,0.951581,-0.0182076,-0.576206,0.116142,-0.683352,-0.108745,0.0572907,1,0.0308885,-0.576206,-0.576206,0.0308885,1,0.0572907],[-7.69522E-12,-3.17007E-11,1.74631E-11,-3.58698E-11,-5.97811E-12,0.0569232,-8.96062E-12,4.95765E-11,5.82231E-12,0.067398,1,0.0624457,-0.0569232,0.0569232,-0.0624457,-1,-0.067398],[-0.0541725,-0.254218,0.0660108,-0.105583,-0.0251459,-0.0346261,-0.0428358,0.312283,0.0330371,0.0678452,1,0.063445,-0.0346261,-0.0346261,0.063445,1,0.0678452],[-2.2265471937305517E-5,-9.1552117929322022E-5,2.7254916341006E-5,-6.375213469255188E-5,-1.0933947635860738E-5,0.013842813289050467,-2.493627353400316E-5,0.00019158171550703531,1.9756409316164989E-5,0.068242584890043687,1,0.0643173698492357,-0.01388660722704747,0.013842813289050467,-0.064253198109945828,-0.9989811099353566,-0.068173698492357007],[0.0652843450206548,0.60732178826260619,-0.23212228158820114,-0.46908926803454981,0.072887789764774155,0.39501681403844185,-0.15862701000307261,0.990915511590591,0.10203144737291317,0.066536542794715089,1,0.031260882182240275,-0.4928913744836298,0.39501681403844185,0.0026594239698200807,-0.091925954218019176,0.0017657407565463794],[-0.1655230393056534,-1,0.20381215698579694,0.31337481572699771,-0.054397390279858147,0.028895013232133664,0.10366710675105235,-0.96133375170952073,-0.080393352554956291,0.0029303877281580989,0.03286275879626066,0.0033790784277738638,0.032700539350056547,0.028895013232133664,0.0038981036901963805,0.043766155339920787,0.0036213419218860082],[0.166141,1,-0.204769,-0.310012,0.054576,-0.0306885,-0.103943,0.962959,0.0804109,-0.0034036,-0.0398121,-0.0036703,-0.0306885,-0.0306885,-0.0036703,-0.0398121,-0.0034036],[0.17306362036049885,0.9501059926115093,-0.12304564500533062,-0.10186013933999455,0.029879596112364563,0.043845300374383264,-0.051768403044653265,1,0.07216144348300399,-0.024655585996578484,-0.19068442714402598,-0.0099182741179679179,-0.12248407011628196,0.043845300374383264,-0.00821526417573699,-0.17303913668708007,-0.0058445007809981905],[0.21137567120640643,1,-0.13560738373497333,0.062945690343917809,0.031164694078519534,0.30876934653759686,-0.051595102283495294,0.99237286561007787,0.061424443990264026,-0.049599598669664256,-0.44448217238624327,-0.027740101447390426,-0.32498838743241487,0.30876934653759686,0.01083350365099125,-0.018964158971405215,0.01137785436911243],[0.23618301298861569,0.93844621426147368,-0.13923690230110494,0.30012517023592827,0.031257608278865187,0.66103547518411931,-0.054301404639232054,1,0.056067891630783066,-0.087264369234566375,-0.75015756464557881,-0.055595858804447958,-0.754463597057618,0.66103547518411931,0.038789154263500977,0.24271346152998577,0.039336553675553464],[0.12432197269123811,0.50039183125664666,-0.032065388618126606,0.20188863803094839,0.0054803714719547768,0.67349480496584979,-0.021321307317406064,0.60249884839144452,0.03579045842550941,-0.073383909327176255,-0.48114489794757764,-0.051141315165405106,-1,0.67349480496584979,0.036839076210895071,0.23878048919194045,0.037320022065388612],[0.01732995906274391,0.11398158619920673,0.0066002166329505087,-0.032804958664521572,-0.0015466278532630337,0.98259768393889679,0.0013307794007550295,0.024262094012328962,0.0014446709887064144,-0.055757498526577354,-0.43172079835613814,-0.055698163398588692,-1,0.98259768393889679,0.055424982876439571,0.4264204590707083,0.054287659886267693],[-0.0055093003244993709,-0.021314321990970646,0.000861274860036144,-0.013496806988128234,-0.00029761480796582914,-0.9734638261727433,0.0014720702705931015,-0.056523056708864122,-0.0037316985230522845,0.056065174161267557,0.44357869496837959,0.056701232743689739,1,-0.9734638261727433,-0.055403235260937753,-0.43118047429553552,-0.054054140740265572],[-0.0062689289184542944,-0.038368992450855822,0.00092467860079228643,-0.011748168771956051,-9.68345915240302E-5,-0.92702836534868083,0.0027641639883399355,-0.12077229239853503,-0.0097973503251364072,0.056050620375214889,0.42629213693101131,0.055514145302339495,1,-0.92702836534868083,-0.052329396815905524,-0.40210404365049707,-0.051503942746094628],[-0.08175784196282,-0.87899492731117923,0.19373145806527944,0.11443483147729122,-0.056098614253811914,0.67425943179969539,0.096649954893000281,-1,-0.095949539317035662,0.011888134640696867,0.034887380392504851,0.044019994971678723,0.2674049425440348,0.67425943179969539,0.027375452918644721,0.46670216069923248,0.058845260807193461],[-8.24563E-12,-5.83586E-11,1.28765E-11,9.559E-12,-3.63591E-12,1,5.11839E-12,-5.36344E-11,-4.37953E-12,-0.0559084,-0.453561,-0.0576231,-1,1,0.0576231,0.453561,0.0559084],[-0.018407947080899257,-0.14658094277507847,-0.022168551636570295,0.26976402463687238,0.0083511675890987486,-0.524805828473712,-0.029202527173773918,1,0.08253429040994896,0.0054102817471085472,0.14975834156781029,0.013041030734651874,0.12761024385998146,-0.524805828473712,-0.037696155480577725,-0.3387288356876258,-0.027845502439623793],[-0.13575603111130641,-1,-0.0950834377599617,0.2375335819368955,0.029555134986885431,-0.18250996661883495,-0.014883696263218744,-0.40625317257441063,-0.03934340778813037,0.055076800923702138,0.065216765436326526,0.02372411368688376,0.9607138690179452,-0.18250996661883495,-0.010143495067072959,-0.024004436679581728,-0.01326565679677189],[-0.110786,-0.883552,0.0860203,1,-0.018212,-0.547231,-0.0426727,0.846047,0.0540507,-0.0245868,-0.114064,-0.0205068,-0.547231,-0.547231,-0.0205068,-0.114064,-0.0245868],[-1.3738586388939456E-6,1.6786655296969467E-6,1.0462005729560895E-6,-3.53333780456257E-6,-7.814891109599409E-7,-1,-9.4634429103869849E-7,8.6123923312031121E-7,7.6857460405668242E-7,0.0439506184668155,0.14883253010893832,0.032287800251027586,0.99993293156144913,-1,-0.032288854183633385,-0.14882678138563393,-0.043953588640522748],[-5.4372436724702505E-11,-2.8438635246786287E-10,-1.94662646563087E-11,6.765852695199298E-12,2.0407414381438329E-12,-1,2.0939243773508652E-12,4.6374099265634544E-11,2.6642218435833728E-14,0.043888784278425089,0.13541855156862115,0.031108804577958015,1,-1,-0.031108804577958015,-0.13541855156862115,-0.043888784278425089],[-0.0630549,-0.537787,0.00609662,0.573033,0.0349333,1,-0.00264499,0.576018,0.0346709,0.0538857,-0.0891652,0.0113925,1,1,0.0113925,-0.0891652,0.0538857],[-0.27275812874582989,-1,-0.13098180220929093,-0.59814754985062057,-0.0039496248271155433,-0.36084298642698193,0.025114258021657294,0.13039009267695925,0.063163359022481338,-0.015063164085046448,0.015582089714781484,-0.0038523376156646928,-0.27565133425054361,-0.36084298642698193,-0.0027307757929089238,0.049172695690684748,-0.020398187844180737],[2.7652937174819541E-12,-5.7756616989380065E-12,-1.3904385920709507E-11,5.2300041572708151E-12,1.3497650512100178E-11,1,4.7276357726854717E-12,4.3075152118318449E-11,2.040542838786077E-12,-0.0880309968631502,0.39941609241739007,0.014372724524118471,-1,1,-0.014372724524118471,-0.39941609241739007,0.0880309968631502],[-0.1229243072345174,-0.9651329737771992,-0.054723228566114931,0.42394718244374185,0.016116942533010971,-0.0012492170355216663,-0.030361167937511625,-1,-0.065044151013576343,0.00063306453412683653,-0.0030375079040357079,-0.00011019602008554957,0.0074329774967453969,-0.0012492170355216663,-6.9457541379951651E-6,0.00015513260182257766,-5.3441844894922822E-5],[0.111488,0.879373,0.0487776,-0.39885,-0.0151719,-0.00125481,0.0308402,1,0.0654922,-0.000342456,0.00232879,0.000167784,-0.00125481,-0.00125481,0.000167784,0.00232879,-0.000342456],[-0.07738033851319856,-0.67479054341145073,0.0087000697157330678,0.8254466550886298,0.033072937507476911,0.91507881177989625,-0.0077570097313262908,0.73960554920734456,0.046602698700152226,0.042389640819593011,-0.24355541988259707,0.0062908342374377608,1,0.91507881177989625,0.010658215524744961,-0.02305338410068767,0.057659448956945379],[0.133303,1,0.0725621,-0.205244,-0.00426004,-0.00792086,-0.0346256,-0.867884,-0.0598859,0.00270955,-0.0220806,-0.00189085,-0.00792086,-0.00792086,-0.00189085,-0.0220806,0.00270955],[0.024766107342010391,0.1832981503500283,-0.029851532049366393,-0.32037285484476041,0.021892537180571364,0.8996776306168256,0.036371468719996441,-0.34956731288905279,-0.025468293985617368,0.049970115658758973,0.046580468357569321,0.034399420116612518,1,0.8996776306168256,0.022651058986602916,0.1752551296153822,0.05487464472604961],[0.10903878885604229,0.89014846123150349,-0.050127531699689726,-1,-0.016610881727785787,-0.72927935631509944,0.028494050963817158,-0.935981692767503,-0.058429552173169481,-0.011407816406472681,0.17854193642960106,0.014948001921933662,-0.0977099671805396,-0.72927935631509944,-0.005975935110307592,0.10770076470157094,-0.037601573379590039],[0.0314938649392878,0.28052187384289307,0.010063968062784888,-0.28885602291444112,-0.031364907367605686,-0.80589544647835176,-0.0053138180378871384,-0.31776507590621422,-0.018514774792412356,-0.051960538131860176,0.040521022637799463,-0.01572746115312754,-1,-0.80589544647835176,-0.00980996846285128,0.064271943003306936,-0.04361787700937602],[0.078728237693212078,0.57474609258238285,-0.066810364869442765,-0.6373757032687466,0.0208433246760148,1,0.027734660936451737,-0.49282217513467552,-0.0322531833912333,0.0043117963161006193,-0.046425169548380232,-0.00033300563943486084,0.14740047958444868,1,0.0310473141278139,0.13445967040193427,0.047101171062857439]]


//*****************************************************************************
//Setup the slideshow for display
var slideIndex = 1;
showSlides(slideIndex);

function plusSlides(n) {
  showSlides(slideIndex += n);
}

function currentSlide(n) {
  showSlides(slideIndex = n);
}

function showSlides(n) {
  var i;
  var slides = document.getElementsByClassName("mySlides");
  if (n > slides.length) {slideIndex = 1}
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
      slides[i].style.display = "none";
  }
  if (slideIndex === 2)
  {
      slides[slideIndex-1].style.display = "grid"
  }
  else {
      slides[slideIndex-1].style.display = "block";
  }
}

//*****************************************************************************
//Define al the constant layouts
const layoutF = {
    autosize: false,
    width: 550,
    height: 450,
    margin: {
    l: 0,
    r: 0,
    b: 0,
    t: 0,
    pad: 0
    },
    xaxis: {range: [-2.1, 0.1], autorange: false},
    yaxis: {range: [-2, 2], autorange: false},
    showlegend:false
}

const layoutW = {
    autosize: false,
    width: 550,
    height: 450,
    margin: {
    l: 0,
    r: 0,
    b: 0,
    t: 0,
    pad: 0
    },
    xaxis: {range: [-1, 1], autorange: false},
    yaxis: {range: [-1, 1], autorange: false},
    showlegend:false
}

const layout3d={
  autosize: false,
  width: 1100,
  height: 500,
  margin: {
    l: 0, r: 0, b: 0, t: 0, pad: 0
  },
  scene: {
    aspectratio:{x:2,y:2.75,z:1},
    aspectmode: "manual",
    camera:{eye:{x:1.75, y:0.75},
    up:{x:0, y:0, z:1}},
  xaxis: {
    range: [-1., 1], autorange: false, title:'x', zeroline: true, showspikes: false, autotick: false, ticks: 'outside', tick0: 0, dtick: 0.5,
  },
  yaxis: {
    range: [-2.1, 0], autorange: false, title:'y', zeroline: true, showspikes: false, autotick: false, ticks: 'outside', tick0: 0, dtick: 0.5,
  },
  zaxis: {
    range: [-1, 1], autorange: false, title:'z', zeroline: true, showspikes: false, autotick: false, ticks: 'outside', tick0: 0, dtick: 1,
  }
  },
  marker: {
    color: 'rgb(139, 0, 0)',
    size: 7,
  },
  mode: 'markers',
  hovermode: false,
  font: {
    family: "Fira Sans",
    size: 14
  },
  legend: {"orientation": "h"}
};

//*****************************************************************************
//Define all traces with zero values
//fuselage
let trace3Daircraft1 ={
  type: 'scatter3d',
  x: [0],
  y: [0],
  z: [0],
  showscale: false,
  name: 'Fuselage',
  line: {shape: 'spline'},
  marker: {
    color: 'rgb(139, 0, 0)',
    size: 10,
  }
};


//wing
let trace3Daircraft2 ={
  type: 'scatter3d',
  x: [0],
  y: [0],
  z: [0],
  showscale: false,
  name: 'Wings',
  line: {shape: 'spline'},
  marker: {
    color: 'rgb(99, 45, 122)',
    size: 10,
  }
};


//fuselage
var traceAircraftV = {
  x: [0],
  y: [0],
  type: 'scatter',
  line: {shape: 'spline'},
  marker: {
    color: 'rgb(139, 0, 0)',
    size: 10,
    }
};

//wing
var traceAircraftH = {
x: [0],
y: [0],
type: 'scatter',
 line: {shape: 'spline'},
marker: {
        color: 'rgb(99, 45, 122)',
        size: 10,
        }
}

//*****************************************************************************
// function to produce the coordinates
function popCoords(n){

  const beamLength = 2.032; //Length of the fuselage and the beam
  let elemLength = beamLength/(0.5*n); //Length of an element
  for (let i = 0; i <= n/2; i++) //Populate fuselage and wing
  {
    fuselageY[i] = -(i*elemLength);
    fuselageX[i] = 0.0;
    fuselageZ[i] = 0.0;
  };

  for (let i = 0; i <=n/2; i++)
  {
    wingY[i] = -(beamLength/2 + Math.abs((n/4 - i)) * elemLength * Math.cos(Math.PI/3)); //X coordinate of wing
    wingX[i] = (n/4 - i) * elemLength * Math.sin(Math.PI/3); //Y coordinate of wing
    wingZ[i] = 0;
  }

  return [fuselageX, fuselageY, fuselageZ, wingX, wingY, wingZ]
}

// function to update my traces with no displacement
function updateTraces(){
  trace3Daircraft1.x = fuselageX;
  trace3Daircraft1.y = fuselageY;
  trace3Daircraft1.z = fuselageZ;
  trace3Daircraft2.x = wingX;
  trace3Daircraft2.y = wingY;
  trace3Daircraft2.z = wingZ;
  traceAircraftV.x = fuselageY;
  traceAircraftV.y = fuselageZ;
  traceAircraftH.x = wingX;
  traceAircraftH.y = wingZ;
}

// function to produce the static and 3d plots
function allStaticPlot()
{
  Plotly.react('fullAircraft', [trace3Daircraft1, trace3Daircraft2], layout3d);
  Plotly.react('wing', [traceAircraftV], layoutF);
  Plotly.react('fuselage', [traceAircraftH], layoutW);
}

// function to get the eigenvectors of the fuselage and the wing
function getEigenVector(nMode)
{
  if (numElems===8){
    let eigVector = eightElems[nMode-1];
    eigVectorF = eigVector.slice(0,5);
    eigVectorW = eigVector.slice(5,7);
    eigVectorW.push(eigVector[2])
    eigVectorW = eigVectorW.concat(eigVector.slice(7,9));
  }
  else if (numElems===16)
  {
    let eigVector = sixteenElems[nMode-1];
    eigVectorF = eigVector.slice(0,9);
    eigVectorW = eigVector.slice(9,13);
    eigVectorW.push(eigVector[4]);
    eigVectorW = eigVectorW.concat(eigVector.slice(13,18));
  }
}

//
const w = 400;
let anim3d;
let t3=0;
let dt=0.00009;
function animate3D (){
  function compute3D () {
    // change the z coordinate by multiplying the eigenvector with a sine function
    for (var i = 0; i <= numElems/2; i++) {
      fuselageZ[i]=eigVectorF[i]*Math.sin(w*t3);
      wingZ[i]=eigVectorW[i]*Math.sin(w*t3);
    }
    t3=t3+dt;
    //console.log(Math.max.apply(Math, eigVectorF));
  }

  compute3D();
  // plot the 3d aircraft with the required changes
  Plotly.animate('fullAircraft', {
    data: [{
    z: fuselageZ,}, {
    z: wingZ,}]
  }, {
    transition: {
      duration: 0
    },
    frame: {
      duration: 0,
      redraw: false
    }
  });
  return;
}

let anim;
function animate2D (){
Plotly.animate('wing', {
  data: [{y:fuselageZ}]
}, {
  transition: {
    duration: 0
  },
  frame: {
    duration: 0,
    redraw: false
  }
});
Plotly.animate('fuselage', {
  data: [{y:wingZ}]
}, {
  transition: {
    duration: 0
  },
  frame: {
    duration: 0,
    redraw: false
  }
});
return;
}


//******************************************************************************
//Slider section
//Get html element Ids
let elemInput = document.getElementById('nElem'),
    elemOutput = document.getElementById('elementDisplay'),
    modeInput = document.getElementById('nMode'),
    modeOutput = document.getElementById('modeDisplay');

//Global variables
let numElems = 0;
let nMode = 1; //Users desired modal shape

let eigVectorF = [];
let eigVectorW = [];

let Coords,fuselageX, fuselageY, fuselageZ, wingX, wingY, wingZ = [];

//Void function to adjust slider to display adjusted output
const sliderVals = [4, 8, 16, 32, 64, 128, 256, 512]; //Slider values for elemnts
let firstTime = true;
elemInput.oninput = function(){
    elemOutput.innerHTML = sliderVals[this.value]; //Output the adjusted value
    numElems = sliderVals[this.value]; //Set number of elements equalt to this
    $('input#nMode').attr('max',numElems*6); //Change the maximum value of the mode slider
    $('#modeSliderMax').html(numElems*6); //Change the display at the end of the slider
    clearInterval(anim);
    clearInterval(anim3d);
    $('input#start').val("Start")
    Coords = [];
    fuselageX = [];
    fuselageY = [];
    fuselageZ = [];
    wingX = [];
    wingY = [];
    wingZ = [];
    Coords = popCoords(numElems);
    fuselageX = Coords[0];
    fuselageY = Coords[1];
    fuselageZ = Coords[2];
    wingX = Coords[3];
    wingY = Coords[4];
    wingZ = Coords[5];
    eigVectorF, eigVectorW = [];
    getEigenVector(nMode);
    updateTraces();
    if (firstTime === true)
    {
      Plotly.newPlot('fullAircraft', [trace3Daircraft1, trace3Daircraft2], layout3d);
      Plotly.newPlot('wing', [traceAircraftV], layoutF);
      Plotly.newPlot('fuselage', [traceAircraftH], layoutW);
      firstTime = false;
    }
    else {
      Plotly.react('fullAircraft', [trace3Daircraft1, trace3Daircraft2], layout3d);
      Plotly.react('wing', [traceAircraftV], layoutF);
      Plotly.react('fuselage', [traceAircraftH], layoutW);
  }
};

elemInput.oninput(); //Default value as specified in html

//Void function for outputing the mode shape
modeInput.oninput = function(){
    modeOutput.innerHTML = this.value;
    nMode = this.value;
    wingZ = [];
    fuselageZ = [];
    eigVectorF = [];
    eigVectorW = [];
    getEigenVector(nMode);
};

modeInput.oninput(); //Default value as specified in html

$('input#start').on('click',begin_animation)

function begin_animation(){

      if ($(this).val().toString()=="Start"){
        wingZ = [];
        fuselageZ = [];
        anim= setInterval(animate2D,30);
        anim3d= setInterval(animate3D,30);
        $(this).val("Pause")
      }else {
            clearInterval(anim);
            clearInterval(anim3d);
            $(this).val("Start")
        };
  }



/******************************************************************************
-------                   Plot the fequency diagram                     -------
Plot the modal frequency versus number of elements
*******************************************************************************/
const numElemArray = [0,0]
let modalFrequencies = [0,0]

let layoutFreq =  {
    autosize: false,
    width: 1100,
    height: 500,
    margin: {
    l: 0,
    r: 0,
    b: 0,
    t: 0,
    pad: 0
    },
    xaxis: {autorange: true, type:'log'},
    yaxis: {autorange: true},
    showlegend:false
}

var frequencyTrace = {
              x: numElemArray,
              y: modalFrequencies,
              type: 'scatter',
               line: {shape: 'spline'},
              marker: {
                      color: 'rgb(99, 45, 122)',
                      size: 14,
                      }
                  }

Plotly.newPlot('freqPlot', [frequencyTrace], layoutFreq);
